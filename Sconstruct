
import os
import sys
from sys import platform

cwd = os.getcwd()

#Environment
main_env = Environment()

# Compile flags
main_env.Append(CXXFLAGS=[
    "-g",
    "-Wall",
    "-w",
    "-Wl,-rpath,\$$ORIGIN",
    "-std=c++17",
    "-fopenmp",
    "-lpthread"
])

debug_mode = True
if debug_mode :
    main_env.Append(CXXFLAGS=[
        "-g",
        "-O0"
    ])
else :
    main_env.Append(CXXFLAGS=[
        "-s",
        "-O0",
        "-DNDEBUG"
    ])

# Include dirs
main_env.Append(CPPPATH=[
    '/usr/include',
    cwd + '/src',
    cwd + '/thirdpart',
    cwd + '/thirdpart/eigen3',
])

# Build dir
main_env.Append(BUILDPATH=os.path.abspath(cwd + '/build'))

# SCONS scripts to build
build_scripts = [
    'src/SConscript',  
    'test/SConscript'
]

for script in build_scripts:
    env = main_env.Clone()
    SConscript(script, exports='env')